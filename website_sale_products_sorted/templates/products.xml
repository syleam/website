<?xml version="1.0" encoding="UTF-8"?>
<openerp>
    <data>
        ##############################################################################
        #
        #    website_sale_products_sorted module for OpenERP, Module
        #    Copyright (C) 2016 SYLEAM Info Services ([http://www.Syleam.fr/])
        #              Yannis Pou-Vich [yannis.pouvich@syleam.fr]
        #
        #    This file is a part of website_sale_products_sorted
        #
        #    website_sale_products_sorted is free software: you can redistribute it and/or modify
        #    it under the terms of the GNU Affero General Public License as published by
        #    the Free Software Foundation, either version 3 of the License, or
        #    (at your option) any later version.
        #
        #    website_sale_products_sorted is distributed in the hope that it will be useful,
        #    but WITHOUT ANY WARRANTY; without even the implied warranty of
        #    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
        #    GNU Affero General Public License for more details.
        #
        #    You should have received a copy of the GNU Affero General Public License
        #    along with this program.  If not, see [http://www.gnu.org/licenses/].
        #
        ##############################################################################

        <!-- Add template to sort product and diplay if checkbox 'products_sorted_ok' is checked in backoffice -->
        <template id="syleam_products" inherit_id="website_sale.products">
            <xpath expr="//t[@t-call='website.pager']" position="after">
                <t t-if="website.products_sorted_ok">
                    <t t-call="website_sale_products_sorted.products_sorted" />
                </t>
            </xpath>
        </template>

        <!-- Template for select field to sort products -->
        <template id="products_sorted">
            <form class="pagination form-inline pull-right" action="/shop"  method="post">
                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                <select class="form-control" name="order" onchange="this.parentNode.submit()">
                    <option value="0">default</option>
                    <t t-foreach="website.field_product_line" t-as="fpl">
                        <option t-att-value="fpl.field_product_id.name">
                            <span t-field="fpl.field_product_id.field_description" /> -/+
                        </option>
                        <option t-att-value="fpl.field_product_id.name + ' DESC'">
                            <span t-field="fpl.field_product_id.field_description" /> +/-
                        </option>
                    </t>
                </select>
            </form>
        </template>
    </data>
</openerp>
